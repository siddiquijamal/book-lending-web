<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lend Book</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body { background: #f7f8fc; }
.card { border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
.price-box { font-size: 1.4rem; font-weight: 600; color: #4a4a4a; }
</style>
</head>
<body>
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card p-4">
        <h3 class="text-center mb-3">Lend This Book</h3>
        <hr>

        <div class="mb-3">
          <label class="form-label fw-semibold">Book Title</label>
          <input type="text" class="form-control" value="{{ book.title }}" readonly>
        </div>

        <form method="POST" action="{% url 'lendBook' book.id %}">
          {% csrf_token %}

          <label class="form-label">Select Lending Duration</label>
          <select id="duration" name="duration" class="form-select mb-3">
            <option value="7">1 Week (7 days)</option>
            <option value="14">2 Weeks (14 days)</option>
            <option value="custom">Custom Days</option>
          </select>

          <div id="customDaysBox" class="mb-3" style="display:none;">
            <label class="form-label">Enter Number of Days</label>
            <input type="number" id="customDays" name="customDays" class="form-control" min="1" placeholder="Enter days">
          </div>

          <div class="price-box text-center my-3">
            Price: â‚¹ <span id="price">0</span>
            <input type="hidden" name="price" id="priceInput" value="0">
          </div>

          <button type="submit" class="btn btn-primary w-100">Lend Book</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
const duration = document.getElementById("duration");
const customDaysBox = document.getElementById("customDaysBox");
const customDays = document.getElementById("customDays");
const price = document.getElementById("price");
const priceInput = document.getElementById("priceInput");

const pricePerDay = 5;

function updatePrice() {
    let days = duration.value;
    if(days === "custom") {
        days = customDays.value || 0;
    }
    const totalPrice = days * pricePerDay;
    price.innerText = totalPrice;
    priceInput.value = totalPrice;
}

duration.addEventListener("change", () => {
    customDaysBox.style.display = duration.value === "custom" ? "block" : "none";
    updatePrice();
});

customDays.addEventListener("input", updatePrice);
updatePrice();
</script>
</body>
</html>
